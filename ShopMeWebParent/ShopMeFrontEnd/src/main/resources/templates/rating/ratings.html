<!DOCTYPE html>
<html lang="en">
<th:block th:replace="fragments/page_structure :: page_header(${pageTitle})"></th:block>
<body>
<div class="container">
    <th:block th:replace="fragments/navigation :: header_nav"></th:block>
    <th:block th:replace="fragments/navigation :: search_nav"></th:block>
    <div>
        <div class="row p-4">
            <div class="col-lg-2 mb-2">
                <img th:src="@{${product.mainImagePath}}" class="img-fluid" />
            </div>
            <div class="col">
                <div><h3>[[${product.name}]]</h3></div>
                <div class="d-flex ms-1 mb-1">
                    <div>
                        <input type="text" class="product-details-star-rating" dir="ltr" data-size="md" th:value="${product.averageRating}" />
                    </div>
                    <div class="mt-3 ms-1">
                        <th:block th:replace="fragments/rating_fragment :: rating_formatter(${product.averageRating})"></th:block>
                    </div>
                </div>
                <div class="mt-2">
                    [[${product.reviewCount}]] rating(s)
                </div>
            </div>
        </div>
        <th:block th:each="review : ${reviews}">
            <div class="ps-4 pe-4 pb-4">
                <div>
                    <input type="text" class="product-details-star-rating" dir="ltr" data-size="xs" th:value="${review.rating}" />
                </div>
                <div class="mt-2"><b>[[${review.headline}]]</b></div>
                <div class="mt-2">[[${review.comment}]]</div>
                <div th:if="${review.moderated}"><sub class="text-info">(moderated)</sub></div>
                <div>
                    <sub>[[${review.customer.fullName}]], [[${#dates.format(review.reviewTime, 'yyyy-MM-dd HH:mm:ss')}]]</sub>
                </div>
                <div><hr></div>
            </div>
        </th:block>
    </div>
    <div class="text-center m-2" th:if="${totalPageNo > 0}">
        <span>Showing Reviews # [[${startNo}]] to [[${endNo}]] of [[${totalItems}]]</span>
        <th:block th:replace="fragments/pagination::pagination_fragment('ratings/' + ${product.alias})"></th:block>
    </div>
    <div class="text-center m-2" th:unless="${totalItems > 0}">
        <h2>No Reviews found</h2>
    </div>
    <th:block th:replace="fragments/navigation :: footer_nav"></th:block>
    <script type="text/javascript">
        moduleURL = "[[@{/reviews}]]";
        const contextPath = "[[@{/}]]";
        const csrfHeaderName = "[[${_csrf.headerName}]]";
        const csrfHeaderValue = "[[${_csrf.token}]]";

        $(document).ready(function () {
            $(".product-details-star-rating").rating({
                displayOnly: true,
                hoverOnClear: false,
                showCaption: false,
                theme: "krajee-svg",
            });
        });
    </script>
</div>
</body>
</html>